<!DOCTYPE html>
<html lang="en" ng-app="wd-students">
  <head>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
<body ng-controller="StudentsListCtrl as ctrl">
<div class="container-fluid">
  <h1>Wirtualny dziekanat 2.0</h1>
  <p>{{ctrl.mod}}</p>
  <div class="table-responsive">
    <table class="table table-hover table-condensed">
    <thead>
      <tr>
        <th>#</th>
        <th>Firstname</th>
        <th>Lastname</th>
        <th>Program</th>
        <th>Age</th>
        <th>PESEL</th>
      </tr>
    </thead>
    <tbody ng-repeat="student in ctrl.students">
      <tr>
        <td ng-bind="::student.id"></td>
        <td ng-bind="::student.first_name"></td>
        <td ng-bind="::student.last_name"></td>
        <td ng-bind="::student.program"></td>
        <td ng-bind="::student.age"></td>
        <td ng-bind="::student.pesel"></td>
      </tr>
    </tbody>
    </table>
  </div>
</div>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-resource.min.js"></script>
<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<script type="text/javascript">
  angular.module('wd-students', ['ngResource'])
    .controller('StudentsListCtrl', ['StudentService',function(studentSrv) {
      var self = this;
      self.mod = 'Hello World!'
      self.students = [];
      var fetchStudents = function() {
          studentSrv.query(
            function (resp) {
              self.students = resp.data;
              console.log("successful request");
              console.log(resp.data);
            }, function (errResponse) {
              console.error('Nie udało się załadować studentów');
            }
          );
      };

      fetchStudents();
    }])
    .factory('StudentService',['$resource', function($resource) {
        return $resource('/api/student/:id');
    }]);
</script>
</body>
</html>
